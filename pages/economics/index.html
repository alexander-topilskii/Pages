<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Карта идей: реалистичность и оптимизм (Canvas)</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
<header class="app-header">
    <h1 id="pageTitle">Карта идей: реалистичность и оптимизм (Canvas)</h1>
    <div class="controls">
        <details>
            <summary>Загрузить/править JSON</summary>
            <div class="json-panel">
                <textarea id="jsonInput" spellcheck="false"></textarea>
                <div class="json-actions">
                    <button id="btnLoad">Загрузить JSON из textarea</button>
                    <button id="btnExport">Скачать текущий JSON</button>
                    <label class="file-inline">
                        <input type="file" id="fileInput" accept="application/json" />
                        <span>Загрузить из файла…</span>
                    </label>
                    <span class="hint">Структура: <code>title, axes, notes, comment, points[]</code>. В точке: <code>title, x, y, size, year, type, url, description, key_takeaways[]</code>.</span>
                </div>
            </div>
        </details>
        <div class="axis-selector">
            <label for="xAxisSelect">Ось X:</label>
            <select id="xAxisSelect"></select>
        </div>
        <div class="axis-selector">
            <label for="yAxisSelect">Ось Y:</label>
            <select id="yAxisSelect"></select>
        </div>
        <div class="zoombar">
            <button id="btnZoomIn" aria-label="Приблизить">＋</button>
            <button id="btnZoomOut" aria-label="Отдалить">－</button>
            <button id="btnReset" aria-label="Сброс масштаба">⟲</button>
        </div>
    </div>
</header>

<main>
    <section class="chart-wrap">
        <div class="chart-container" id="chartContainer" aria-label="Диаграмма (Canvas)">
            <canvas id="chartCanvas"></canvas>
            <div id="tooltip" class="tooltip" hidden></div>
        </div>
        <div class="legend">
            <div>
                <span class="dot" style="width: 10px; height: 10px; background: rgb(0, 0, 255);"></span>
                <span style="margin: 0 6px;">Low Influence</span>
                <span class="dot" style="width: 15px; height: 15px; background: rgb(127, 0, 127);"></span>
                <span style="margin: 0 6px;">Medium Influence</span>
                <span class="dot" style="width: 20px; height: 20px; background: rgb(255, 0, 0);"></span>
                <span style="margin: 0 6px;">High Influence</span>
            </div>
            <div>Размер и цвет точки — функция <b>влияния</b> (интервал 0–100).</div>
            <div><b>Тип:</b> круг = прочие, квадрат = книга. Колёсико/пинч — масштаб, перетаскивание — панорама, клик — карточка слева.</div>
        </div>
    </section>

    <section class="below-grid">
        <div class="col col-notes">
            <div id="selectedCard" class="selected-card" hidden></div>

            <h2>Notes</h2>
            <ul id="notesList" class="notes"></ul>

        </div>

        <div class="col col-resources">
            <h2>Resources</h2>
            <ol id="resourcesList" class="resources"></ol>
        </div>
    </section>
</main>

<footer class="app-footer">
    <small>Единственный Canvas. Для локального запуска откройте файл через простой http-сервер (из-за fetch-политики браузера) или работайте через панель JSON.</small>
</footer>

<script src="script.js"></script>
</body>
</html>
